(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14452,        343]
NotebookOptionsPosition[     12825,        311]
NotebookOutlinePosition[     13169,        326]
CellTagsIndexPosition[     13126,        323]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Estimating Subgraph Generation Models to Understand Large Network Formation\
\>", "Title",
 CellChangeTimes->{{3.7311485430970516`*^9, 3.7311485535042944`*^9}, {
  3.7347687641896825`*^9, 3.7347687695334415`*^9}, {3.737087017951931*^9, 
  3.737087018233037*^9}},ExpressionUUID->"1438e0c4-d383-4d43-a958-\
6af0b8db3e87"],

Cell["\<\
Estimating Bicoloured Subgraph Generation Models for Network of Directors\
\>", "Subtitle",
 CellChangeTimes->{{3.7362513054613028`*^9, 3.7362514105561385`*^9}, 
   3.7364396586222906`*^9, {3.739613003002882*^9, 3.7396130797397566`*^9}, {
   3.7462784853648124`*^9, 3.7462784998050275`*^9}, {3.7475486489819937`*^9, 
   3.7475486665603094`*^9}, {3.7482471273138123`*^9, 
   3.7482471777756643`*^9}},ExpressionUUID->"979f4c96-5f9e-4979-880f-\
a1bd0ecdc964"],

Cell["\<\
Laurens Bogaardt | Netherlands eScience Center | l.bogaardt@esciencecenter.nl\
\[LineSeparator]Frank W. Takes | University of Amsterdam | takes@uva.nl
Project time frame: January 2018 - October 2018\
\>", "Subsubtitle",
 CellChangeTimes->{{3.7362513054613028`*^9, 3.7362514105561385`*^9}, 
   3.7364396586222906`*^9, {3.739613003002882*^9, 
   3.7396130797397566`*^9}},ExpressionUUID->"d10d2ce0-f401-4e05-ae0d-\
61c7e5aadefc"],

Cell[CellGroupData[{

Cell["Network of Directors", "Section",
 CellChangeTimes->{{3.7313945520470543`*^9, 3.7313945691579266`*^9}, {
  3.7362514851711984`*^9, 3.7362514878591967`*^9}, {3.7462787454606495`*^9, 
  3.7462787575260987`*^9}, {3.74627883176466*^9, 3.7462788343360558`*^9}, {
  3.7475486378571944`*^9, 3.7475486571696777`*^9}, {3.748247124506422*^9, 
  3.7482471447854548`*^9}},ExpressionUUID->"fe44e697-cb6e-4199-8b2b-\
067697adff1e"],

Cell[CellGroupData[{

Cell["Directors Network", "Subsection",
 CellChangeTimes->{{3.7313136105953646`*^9, 3.7313136348285203`*^9}, 
   3.7313961390776787`*^9, {3.734768800377195*^9, 3.7347688028302975`*^9}, {
   3.7381393890128098`*^9, 3.7381393929282093`*^9}, 3.738387759252408*^9, {
   3.738389076189915*^9, 3.7383890765650454`*^9}, {3.745644216654915*^9, 
   3.745644217151554*^9}, {3.7456443295593433`*^9, 3.7456443307192435`*^9}, {
   3.7456567156030474`*^9, 3.7456567167188864`*^9}, {3.7457257170477457`*^9, 
   3.7457257226532755`*^9}, {3.7462788726117897`*^9, 
   3.7462788743511906`*^9}, {3.7463469919789724`*^9, 3.7463470167854514`*^9}, 
   3.7463471184545183`*^9, {3.747548737560296*^9, 
   3.7475487442165594`*^9}},ExpressionUUID->"e7c5f34d-a1f2-4820-9b0c-\
25c2c82c916f"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, {
  3.7395951311034613`*^9, 3.739595270151494*^9}, {3.7396105997248383`*^9, 
  3.7396106009279623`*^9}, {3.7396106748733125`*^9, 3.7396106809048944`*^9}, {
  3.7396155562576528`*^9, 3.7396155633511143`*^9}, {3.739678930437232*^9, 
  3.739678931265354*^9}, {3.7462788797488127`*^9, 
  3.7462788805411267`*^9}},ExpressionUUID->"fcd4b528-149b-4300-a17e-\
3069dbb1da68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"directorsCounts", "=", 
   RowBox[{"{", 
    RowBox[{
    "714129801", ",", "2358949", ",", "324", ",", "1051", ",", "195776301382",
      ",", "172810736", ",", "0", ",", "17001", ",", "0", ",", "21809", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "188495676127", ",", "173888676", ",", "25343", ",", "20025"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7474928205297327`*^9, 3.747492861998032*^9}, {
  3.748247201128788*^9, 
  3.7482472051603894`*^9}},ExpressionUUID->"96f75f4b-51d5-4fd9-934f-\
4e5b674b9492"],

Cell[BoxData[
 RowBox[{
  RowBox[{"directorsLikelihoodFixed", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"bicolouredCensusLogLikelihoods", "[", "3", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Links\>\"", ",", "\"\<Triangles\>\""}], "}"}], "]"}], "[", 
    RowBox[{"nMales", ",", "nFemales", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pL", ",", "pL", ",", "pL"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pT", ",", "pT", ",", "pT", ",", "pT"}], "}"}]}], "}"}], ",", 
     "directorsCounts", ",", " ", 
     RowBox[{"degreesOfFreedomCompensator", "[", 
      RowBox[{"3", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"Values", "[", 
         RowBox[{"subgraphEdgeCounts", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"\"\<Links\>\"", ",", "\"\<Triangles\>\""}], "}"}], "]"}],
           "]"}], "]"}], "]"}], ",", "nTotal"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.747492890822253*^9, 3.7474929503987217`*^9}, {
   3.7474931863142624`*^9, 3.747493197043007*^9}, {3.747493392772225*^9, 
   3.7474934365256186`*^9}, {3.747552453673502*^9, 3.747552456082773*^9}, 
   3.7475531686048393`*^9, {3.748060592846221*^9, 3.7480605928497534`*^9}, {
   3.748064191050909*^9, 3.7480641925110703`*^9}, {3.748247199881173*^9, 
   3.748247209648559*^9}},ExpressionUUID->"6a206423-5ad7-45c8-a245-\
913dbd9ed3de"],

Cell[BoxData[
 RowBox[{"NArgMax", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"directorsLikelihoodFixed", ",", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "30"}]}], "<", 
      RowBox[{"{", 
       RowBox[{"pL", ",", "pT"}], "}"}], "<", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pL", ",", "pT"}], "}"}], ",", 
   RowBox[{"WorkingPrecision", "\[Rule]", "30"}], ",", 
   RowBox[{"MaxIterations", "\[Rule]", 
    RowBox[{"10", "^", "5"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.747492979806108*^9, 3.7474929886968684`*^9}, {
  3.7474930193373365`*^9, 3.747493021290226*^9}, {3.747549118980569*^9, 
  3.7475491217306023`*^9}, {3.747552527137363*^9, 3.747552590235668*^9}, {
  3.747552712593821*^9, 3.747552808187574*^9}, {3.7475528401484175`*^9, 
  3.7475528614463353`*^9}, {3.747553182541762*^9, 3.7475532260607586`*^9}, {
  3.7475533014889593`*^9, 3.7475533037274513`*^9}, {3.74806406048715*^9, 
  3.7480640625575495`*^9}, {3.7480641696954436`*^9, 3.748064183437276*^9}, {
  3.7482471983373976`*^9, 
  3.748247210840317*^9}},ExpressionUUID->"440d6e56-5308-4edf-b97e-\
23e243931c30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"directorsLikelihoodFixed2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"bicolouredCensusLogLikelihoods", "[", "3", "]"}], "[", 
     RowBox[{"{", "\"\<Triangles\>\"", "}"}], "]"}], "[", 
    RowBox[{"nMales", ",", "nFemales", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"pT", ",", "pT", ",", "pT", ",", "pT"}], "}"}], "}"}], ",", 
     "directorsCounts", ",", " ", 
     RowBox[{"degreesOfFreedomCompensator", "[", 
      RowBox[{"3", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"Values", "[", 
         RowBox[{"subgraphEdgeCounts", "[", 
          RowBox[{"[", 
           RowBox[{"{", "\"\<Triangles\>\"", "}"}], "]"}], "]"}], "]"}], 
        "]"}], ",", "nTotal"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.747492890822253*^9, 3.7474929503987217`*^9}, {
   3.7474931863142624`*^9, 3.747493197043007*^9}, {3.747493392772225*^9, 
   3.7474934365256186`*^9}, {3.747552453673502*^9, 3.747552456082773*^9}, 
   3.7475531686048393`*^9, {3.748060592846221*^9, 3.7480605928497534`*^9}, {
   3.748064191050909*^9, 3.7480641925110703`*^9}, {3.748064652428326*^9, 
   3.748064693210782*^9}, {3.748064830349064*^9, 3.7480648314030104`*^9}, {
   3.748065141171874*^9, 3.748065145674023*^9}, {3.748247197137639*^9, 
   3.7482472139205484`*^9}},ExpressionUUID->"b8ffca44-5fd5-42d5-89d6-\
ba87e8ed18b8"],

Cell[BoxData[
 RowBox[{"NArgMax", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"directorsLikelihoodFixed2", ",", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "30"}]}], "<", 
      RowBox[{"{", "pT", "}"}], "<", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}]}], "}"}], ",", 
   RowBox[{"{", "pT", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.747492979806108*^9, 3.7474929886968684`*^9}, {
  3.7474930193373365`*^9, 3.747493021290226*^9}, {3.747549118980569*^9, 
  3.7475491217306023`*^9}, {3.747552527137363*^9, 3.747552590235668*^9}, {
  3.747552712593821*^9, 3.747552808187574*^9}, {3.7475528401484175`*^9, 
  3.7475528614463353`*^9}, {3.747553182541762*^9, 3.7475532260607586`*^9}, {
  3.7475533014889593`*^9, 3.7475533037274513`*^9}, {3.74806406048715*^9, 
  3.7480640625575495`*^9}, {3.7480641696954436`*^9, 3.748064183437276*^9}, {
  3.7480646390843353`*^9, 3.74806464489148*^9}, {3.7480646983310614`*^9, 
  3.7480646995393343`*^9}, {3.7480651332600493`*^9, 3.748065136826132*^9}, {
  3.748065797865153*^9, 3.7480658132321367`*^9}, {3.748247195472953*^9, 
  3.7482472149848022`*^9}},ExpressionUUID->"8c9ad02d-ea26-4d5f-86e6-\
186f431531ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"directorsLikelihood", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"bicolouredCensusLogLikelihoods", "[", "3", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Links\>\"", ",", "\"\<Triangles\>\""}], "}"}], "]"}], "[", 
    RowBox[{"nMales", ",", "nFemales", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pLa", ",", "pLab", ",", "pLb"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pTa", ",", "pTab", ",", "pTab", ",", "pTb"}], "}"}]}], "}"}],
      ",", "directorsCounts", ",", 
     RowBox[{"degreesOfFreedomCompensator", "[", 
      RowBox[{"3", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"Values", "[", 
         RowBox[{"subgraphEdgeCounts", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"\"\<Links\>\"", ",", "\"\<Triangles\>\""}], "}"}], "]"}],
           "]"}], "]"}], "]"}], ",", "nTotal"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.747492890822253*^9, 3.747492973447051*^9}, {
  3.7474931898921614`*^9, 3.747493193829794*^9}, {3.7474933949127207`*^9, 
  3.7474934395412602`*^9}, {3.7480605928562174`*^9, 3.7480605928597174`*^9}, {
  3.7480642246888137`*^9, 3.74806422732623*^9}, {3.7482471943946223`*^9, 
  3.7482472191440644`*^9}},ExpressionUUID->"9c13bdc9-89ec-4f20-9c63-\
3ed2b80bde8e"],

Cell[BoxData[
 RowBox[{"NArgMax", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"directorsLikelihood", ",", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "30"}]}], "<", 
      RowBox[{"{", 
       RowBox[{
       "pLa", ",", "pLab", ",", "pLb", ",", "pTa", ",", "pTab", ",", "pTb"}], 
       "}"}], "<", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "pLa", ",", "pLab", ",", "pLb", ",", "pTa", ",", "pTab", ",", "pTb"}], 
    "}"}], ",", 
   RowBox[{"WorkingPrecision", "\[Rule]", "30"}], ",", 
   RowBox[{"MaxIterations", "\[Rule]", 
    RowBox[{"10", "^", "5"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.747492979806108*^9, 3.7474930171185045`*^9}, {
  3.747552796070871*^9, 3.7475528665406857`*^9}, {3.747553282634376*^9, 
  3.7475532979045463`*^9}, {3.748064074367197*^9, 3.7480640762211957`*^9}, {
  3.748064240800171*^9, 3.7480642560696697`*^9}, {3.748247192993009*^9, 
  3.74824722209632*^9}},ExpressionUUID->"846635d0-c06b-4e71-830e-\
2a7126ea03d5"],

Cell[BoxData[
 RowBox[{"NArgMax", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"directorsLikelihood", ",", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "30"}]}], "<", 
      RowBox[{"{", 
       RowBox[{
       "pLa", ",", "pLab", ",", "pLb", ",", "pTa", ",", "pTab", ",", "pTb"}], 
       "}"}], "<", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "pLa", ",", "pLab", ",", "pLb", ",", "pTa", ",", "pTab", ",", "pTb"}], 
    "}"}], ",", 
   RowBox[{"AccuracyGoal", "\[Rule]", "20"}], ",", 
   RowBox[{"PrecisionGoal", "\[Rule]", "20"}], ",", 
   RowBox[{"WorkingPrecision", "\[Rule]", "30"}], ",", 
   RowBox[{"MaxIterations", "\[Rule]", 
    RowBox[{"10", "^", "5"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.747492979806108*^9, 3.7474930171185045`*^9}, {
   3.747552796070871*^9, 3.7475528665406857`*^9}, {3.747553282634376*^9, 
   3.7475532979045463`*^9}, {3.748064074367197*^9, 3.7480640762211957`*^9}, {
   3.748064240800171*^9, 3.7480642560696697`*^9}, {3.74806454350121*^9, 
   3.748064569484296*^9}, 3.748247191881487*^9, 
   3.748247222920486*^9},ExpressionUUID->"ba2a8dce-6c95-4c0c-be9a-\
1260881a18ad"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1007},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 329, 6, 96, "Title",ExpressionUUID->"1438e0c4-d383-4d43-a958-6af0b8db3e87"],
Cell[912, 30, 466, 8, 53, "Subtitle",ExpressionUUID->"979f4c96-5f9e-4979-880f-a1bd0ecdc964"],
Cell[1381, 40, 436, 8, 72, "Subsubtitle",ExpressionUUID->"d10d2ce0-f401-4e05-ae0d-61c7e5aadefc"],
Cell[CellGroupData[{
Cell[1842, 52, 423, 6, 67, "Section",ExpressionUUID->"fe44e697-cb6e-4199-8b2b-067697adff1e"],
Cell[CellGroupData[{
Cell[2290, 62, 762, 11, 53, "Subsection",ExpressionUUID->"e7c5f34d-a1f2-4820-9b0c-25c2c82c916f"],
Cell[3055, 75, 456, 7, 34, "Text",ExpressionUUID->"fcd4b528-149b-4300-a17e-3069dbb1da68"],
Cell[3514, 84, 588, 13, 28, "Input",ExpressionUUID->"96f75f4b-51d5-4fd9-934f-4e5b674b9492"],
Cell[4105, 99, 1402, 32, 28, "Input",ExpressionUUID->"6a206423-5ad7-45c8-a245-913dbd9ed3de"],
Cell[5510, 133, 1164, 26, 28, "Input",ExpressionUUID->"440d6e56-5308-4edf-b97e-23e243931c30"],
Cell[6677, 161, 1365, 28, 28, "Input",ExpressionUUID->"b8ffca44-5fd5-42d5-89d6-ba87e8ed18b8"],
Cell[8045, 191, 1175, 23, 28, "Input",ExpressionUUID->"8c9ad02d-ea26-4d5f-86e6-186f431531ec"],
Cell[9223, 216, 1329, 31, 48, "Input",ExpressionUUID->"9c13bdc9-89ec-4f20-9c63-3ed2b80bde8e"],
Cell[10555, 249, 1035, 26, 28, "Input",ExpressionUUID->"846635d0-c06b-4e71-830e-2a7126ea03d5"],
Cell[11593, 277, 1192, 29, 28, "Input",ExpressionUUID->"ba2a8dce-6c95-4c0c-be9a-1260881a18ad"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

